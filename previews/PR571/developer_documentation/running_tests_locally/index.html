<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Running Tests Locally · Mooncake.jl</title><meta name="title" content="Running Tests Locally · Mooncake.jl"/><meta property="og:title" content="Running Tests Locally · Mooncake.jl"/><meta property="twitter:title" content="Running Tests Locally · Mooncake.jl"/><meta name="description" content="Documentation for Mooncake.jl."/><meta property="og:description" content="Documentation for Mooncake.jl."/><meta property="twitter:description" content="Documentation for Mooncake.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Mooncake.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Mooncake.jl</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../interface/">Interface</a></li><li><span class="tocitem">Understanding Mooncake.jl</span><ul><li><a class="tocitem" href="../../understanding_mooncake/introduction/">Introduction</a></li><li><a class="tocitem" href="../../understanding_mooncake/algorithmic_differentiation/">Algorithmic Differentiation</a></li><li><a class="tocitem" href="../../understanding_mooncake/rule_system/">Mooncake.jl&#39;s Rule System</a></li></ul></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../../utilities/defining_rules/">Defining Rules</a></li><li><a class="tocitem" href="../../utilities/debug_mode/">Debug Mode</a></li><li><a class="tocitem" href="../../utilities/debugging_and_mwes/">Debugging and MWEs</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li class="is-active"><a class="tocitem" href>Running Tests Locally</a><ul class="internal"><li><a class="tocitem" href="#Main-Testing-Functionality"><span>Main Testing Functionality</span></a></li><li><a class="tocitem" href="#Extension-and-Integration-Testing"><span>Extension and Integration Testing</span></a></li></ul></li><li><a class="tocitem" href="../developer_tools/">Developer Tools</a></li><li><a class="tocitem" href="../ir_representation/">IR Representation</a></li><li><a class="tocitem" href="../forwards_mode_design/">Forwards-Mode Design</a></li><li><a class="tocitem" href="../reverse_mode_design/">Reverse-Mode Design</a></li><li><a class="tocitem" href="../misc_internals_notes/">Misc. Internals Notes</a></li><li><a class="tocitem" href="../internal_docstrings/">Internal Docstrings</a></li></ul></li><li><a class="tocitem" href="../../known_limitations/">Known Limitations</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Documentation</a></li><li class="is-active"><a href>Running Tests Locally</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Running Tests Locally</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/chalk-lab/Mooncake.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/chalk-lab/Mooncake.jl/blob/main/docs/src/developer_documentation/running_tests_locally.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Running-Tests-Locally"><a class="docs-heading-anchor" href="#Running-Tests-Locally">Running Tests Locally</a><a id="Running-Tests-Locally-1"></a><a class="docs-heading-anchor-permalink" href="#Running-Tests-Locally" title="Permalink"></a></h1><p>Mooncake.jl&#39;s test suite is fairly extensive. While you can use <code>Pkg.test</code> to run the test suite in the standard manner, this is not usually optimal in Mooncake.jl, and will not run all of the tests. When editing some code, you typically only want to run the tests associated with it, not the entire test suite.</p><p>There are two workflows for running tests, discussed below.</p><h2 id="Main-Testing-Functionality"><a class="docs-heading-anchor" href="#Main-Testing-Functionality">Main Testing Functionality</a><a id="Main-Testing-Functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Testing-Functionality" title="Permalink"></a></h2><p>For all code in <code>src</code>, Mooncake&#39;s tests are organised as follows:</p><ol><li>Things that are required for most / all test suites are loaded up in <code>test/front_matter.jl</code>.</li><li>The tests for something in <code>src</code> are located in an identically-named file in <code>test</code>. e.g. the unit tests for <code>src/rrules/new.jl</code> are located in <code>test/rrules/new.jl</code>.</li></ol><p>Thus, a workflow that I (Will) find works very well is the following:</p><ol><li>Ensure that you have Revise.jl and TestEnv.jl installed in your default environment.</li><li>start the REPL, <code>dev</code> Mooncake.jl, and navigate to the top level of the Mooncake.jl directory.</li><li><code>using TestEnv, Revise</code>. Better still, load both of these in your <code>.julia/config/startup.jl</code> file so that you don&#39;t ever forget to load them.</li><li>Run the following: <code>using Pkg; Pkg.activate(&quot;.&quot;); TestEnv.activate(); include(&quot;test/front_matter.jl&quot;);</code> to set up your environment.</li><li><code>include</code> whichever test file you want to run the tests from.</li><li>Modify code, and re-<code>include</code> tests to check it has done was you need. Loop this until done.</li><li>Make a PR. This runs the entire test suite – I find that I almost <em>never</em> run the entire test suite locally.</li></ol><p>The purpose of this approach is to:</p><ol><li>Avoid restarting the REPL each time you make a change, and</li><li>Run the smallest bit of the test suite possible when making changes, in order to make development a fast and enjoyable process.</li></ol><p>If you find that this strategy leaves you running more of the test suite than you would like, consider copy + pasting specific tests into the REPL, or commenting out a chunk of tests in the file that you are editing during development (try not to commit this). I find this is rather crude strategy effective in practice.</p><h2 id="Extension-and-Integration-Testing"><a class="docs-heading-anchor" href="#Extension-and-Integration-Testing">Extension and Integration Testing</a><a id="Extension-and-Integration-Testing-1"></a><a class="docs-heading-anchor-permalink" href="#Extension-and-Integration-Testing" title="Permalink"></a></h2><p>Mooncake now has quite a lot of package extensions, and a large number of integration tests. Unfortunately, these come with a lot of additional dependencies. To avoid these dependencies causing CI to take much longer to run, we locate all tests for extensions and integration testing in their own environments. These can be found in the <code>test/ext</code> and <code>test/integration_testing</code> directories respectively.</p><p>These directories comprise a single <code>.jl</code> file, and a <code>Project.toml</code>. You should run these tests by simply <code>include</code>ing the <code>.jl</code> file. Doing so will activate the environemnt, ensure that the correct version of Mooncake is used, and run the tests.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../utilities/debugging_and_mwes/">« Debugging and MWEs</a><a class="docs-footer-nextpage" href="../developer_tools/">Developer Tools »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.0 on <span class="colophon-date" title="Friday 9 May 2025 16:48">Friday 9 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
